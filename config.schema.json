{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://opencode.ai/config.json",
  "title": "OpenModel Configuration",
  "description": "Configuration schema for OpenModel server",
  "type": "object",
  "required": ["server", "providers", "models"],
  "properties": {
    "server": {
      "type": "object",
      "description": "Server settings",
      "required": ["port", "host"],
      "properties": {
        "port": {
          "type": "integer",
          "minimum": 1,
          "maximum": 65535,
          "default": 11435,
          "description": "Port to listen on"
        },
        "host": {
          "type": "string",
          "default": "localhost",
          "description": "Host to bind to"
        }
      }
    },
    "providers": {
      "type": "object",
      "description": "Map of provider names to provider configurations",
      "additionalProperties": {
        "type": "object",
        "required": ["url"],
        "properties": {
          "url": {
            "type": "string",
            "description": "Base URL for the OpenAI-compatible API"
          },
          "apiKey": {
            "type": "string",
            "description": "API key for authentication"
          }
        }
      }
    },
    "models": {
      "type": "object",
      "description": "Map of model names to their provider configurations",
      "additionalProperties": {
        "type": "array",
        "items": {
          "type": "object",
          "required": ["provider", "model"],
          "properties": {
            "provider": {
              "type": "string",
              "description": "Name of the provider from providers config"
            },
            "model": {
              "type": "string",
              "description": "Model name on that provider"
            }
          }
        }
      }
    },
    "thresholds": {
      "type": "object",
      "description": "Failure threshold settings",
      "properties": {
        "failures_before_switch": {
          "type": "integer",
          "minimum": 1,
          "default": 3,
          "description": "Number of failures before switching to next provider"
        },
        "initial_timeout_ms": {
          "type": "integer",
          "minimum": 0,
          "default": 10000,
          "description": "Initial timeout in milliseconds"
        },
        "max_timeout_ms": {
          "type": "integer",
          "minimum": 0,
          "default": 300000,
          "description": "Maximum timeout in milliseconds"
        }
      }
    },
    "log_level": {
      "type": "string",
      "enum": ["debug", "info", "warn", "error"],
      "default": "info",
      "description": "Logging level"
    },
    "log_format": {
      "type": "string",
      "enum": ["text", "json"],
      "default": "text",
      "description": "Log output format"
    }
  }
}
